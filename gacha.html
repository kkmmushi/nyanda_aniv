<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Anniversaryã€€ã«ã‚ƒã‚“ã ãµã‚‹ã‚¹ãƒ†ãƒƒã‚«ãƒ¼ã€€ç‰¹åˆ¥ã‚¬ãƒãƒ£</title>
  <style>
    html, body {
      overflow-x: hidden;
    }

    body {
      margin: 0;
      background-color: #ffe6f0;
      color: #664455;
      font-family: "ãƒ¡ã‚¤ãƒªã‚ª", meiryo, sans-serif;
      line-height: 1.8;
    }

    body::before {
      content: "";
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background-image: url('haikei1.png');
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center;
      opacity: 0.2;
      z-index: -1;
    }

    @media (max-width: 600px) {
      body::before {
        background-image: url('haikeis1.png');
        background-size: 130% auto;
        background-position: top center;
      }
    }

    .top-back-button,
    .gacha-button {
      background-color: #ea7ca9;
      color: #fff;
      padding: 8px 16px;
      font-size: 1rem;
      border: none;
      border-radius: 20px;
      box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
      cursor: pointer;
      font-family: "M PLUS Rounded 1c", meiryo, sans-serif;
    }

    .top-back-button {
      position: fixed;
      top: 15px;
      left: 15px;
      z-index: 1000;
    }

    .top-back-button:hover,
    .gacha-button:hover {
      background-color: #d86796;
    }

    .container {
      max-width: 900px;
      margin: auto;
      padding: 60px 20px 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    h1 {
      font-size: 1.76rem;
      color: #aa336a;
      line-height: 1.4;
      margin-bottom: 0.5em;
    }

    .subtext {
      font-size: 0.76rem;
      color: #996677;
      margin-bottom: 2em;
      max-width: 600px;
    }

    .gacha-image img {
      max-width: 240px;
      width: 100%;
    }

    .gacha-button {
      margin: 20px auto;
    }

    .sticker-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(48px, 1fr));
      gap: 6px;
      margin-top: 20px;
      width: 100%;
      max-width: 900px;
      justify-items: center;
    }

    .sticker-button {
      padding: 8px 12px;
      font-size: 1.2rem;
      border-radius: 12px;
      border: none;
      cursor: pointer;
      min-width: 48px;
      background-color: transparent;
      color: #aa6688;
      transition: background-color 0.3s;
    }

    .sticker-button.owned {
      background-color: #fff;
      color: #aa6688;
    }

    .sticker-button.locked {
      background-color: transparent;
      color: #aaa;
      cursor: not-allowed;
    }

    .modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(255, 255, 255, 0.8);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 2000;
      flex-direction: column;
      text-align: center;
      padding: 32px;
      border-radius: 25px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      max-width: 90%;
      max-height: 90vh;
      overflow-y: auto;
    }

    .modal img {
      width: auto;
      max-width: 400px;
      height: auto;
      border-radius: 14px;
      margin-bottom: 15px;
    }

    .modal .sticker-title {
      font-size: 2.88rem;
      font-weight: bold;
      margin-bottom: 12px;
      color: #cc3366;
    }

    .modal .sticker-flavor {
      font-size: 1.56rem;
      color: #775566;
    }

    @media(min-width: 768px) {
      h1 {
        font-size: 2.24rem;
      }

      .subtext {
        font-size: 0.84rem;
      }
    }

    @media (max-width: 600px) {
      h1 {
        font-size: 1.4rem;
      }

      .subtext {
        font-size: 0.7rem;
      }

      .modal {
        max-width: 60vw !important;
        padding: 20px;
      }

      .modal img {
        width: auto !important;
        max-width: 80vw !important;
        height: auto !important;
      }

      .modal .sticker-title {
        font-size: 2.1rem;
      }

      .modal .sticker-flavor {
        font-size: 1.1rem;
      }
    }

    @keyframes shake {
      0% { transform: translate(0, 0); }
      20% { transform: translate(-3px, 0); }
      40% { transform: translate(3px, 0); }
      60% { transform: translate(-2px, 0); }
      80% { transform: translate(2px, 0); }
      100% { transform: translate(0, 0); }
    }

    .shake {
      animation: shake 0.4s ease;
    }
  </style>
</head>

<body>

<button class="top-back-button" id="backButton">â† ã‚‚ã©ã‚‹</button>

<div class="container">
  <h1>Anniversary<br>ã«ã‚ƒã‚“ã ãµã‚‹ã‚¹ãƒ†ãƒƒã‚«ãƒ¼ã€€ç‰¹åˆ¥ã‚¬ãƒãƒ£</h1>
  <p class="subtext">
    æœŸé–“é™å®šã‚¬ãƒãƒ£ç™»å ´ï¼ã«ã‚ƒã‚“ã ãµã‚‹ãƒ¡ãƒ³ãƒãƒ¼ã®ã‚¹ãƒ†ãƒƒã‚«ãƒ¼ã‚’é›†ã‚ã‚ˆã†ï¼<br>
    ã©ã‚Œã ã‘é›†ã‚ã‚‰ã‚Œã‚‹ã‹ãªï¼Ÿï¼ï¼Ÿï¼å…¨éƒ¨é›†ã‚ãŸã‚‰è‡ªæ…¢ã—ã‚ˆã†ï¼ï¼ï¼( ã£Â¯ Â³Â¯ )ã£~â™¡ï¼ï¼ 
  </p>
  <div class="gacha-image">
    <img src="images2/gacha_main.png" alt="ã‚¬ãƒãƒ£ç­ä½“ç”»åƒ" id="gachaMachine" />
  </div>
  <button class="gacha-button" id="gachaButton">ã‚¬ãƒãƒ£ã‚’å›ã™</button>
  <div class="sticker-grid" id="stickerGrid"></div>
</div>

<div class="modal" id="stickerModal">
  <img src="" alt="ã‚¹ãƒ†ãƒƒã‚«ãƒ¼ç”»åƒ" id="modalImage" />
  <div class="sticker-title" id="stickerTitle"></div>
  <div class="sticker-flavor" id="stickerFlavor"></div>
</div>

<audio id="gachaSound" src="gachagacha.mp3" preload="auto"></audio>

<script>
  const backButton = document.getElementById('backButton');
  backButton.addEventListener('click', () => {
    const audio = new Audio('back.mp3');
    audio.play();
    audio.addEventListener('ended', () => {
      location.href = 'toppage.html?skipCat=1';
    });
    setTimeout(() => {
      location.href = 'toppage.html?skipCat=1';
    }, 300);
  });

  const gachaButton = document.getElementById("gachaButton");
  const stickerGrid = document.getElementById("stickerGrid");
  const modal = document.getElementById("stickerModal");
  const modalImage = document.getElementById("modalImage");
  const stickerTitle = document.getElementById("stickerTitle");
  const stickerFlavor = document.getElementById("stickerFlavor");
  const gachaMachine = document.getElementById("gachaMachine");
  const gachaSound = document.getElementById("gachaSound");

  const totalStickers = 43;

  const stickerData = {
    1: { title: "ã¿ã‚‹ã", flavor: "ã„ã¤ã§ã‚‚ï½²ï½ªï½±ğŸ¤" },
    2: { title: "AAA", flavor: "çœ¼å…‰é‹­ã„ã‘ã©é¼»â—¯ãé£›ã°ã™ã‚ˆ" },
    3: { title: "ã•ã‚“ã¾", flavor: "ã•ã¾ã¡ã‚»ãƒ¼ãƒ©ãƒ¼ã ã£ã‘ï¼Ÿ" },
    4: { title: "ã‚ã‚“ãš", flavor: "çˆ†èµ°ï¼è¿½èµ°ï¼ã‚ã‚“ã¡ã‚ƒã‚“ğŸ¤" },
    5: { title: "ãŸãŠã±ã„", flavor: "ãã®Ï€Ï€ã«åŒ…ã¾ã‚ŒãŸã„äººç¶šå‡º" },
    6: { title: "RRR", flavor: "ã‚‹ã‚‹ã¡ãƒ•ã‚£ãƒ¼ãƒãƒ¼ğŸ¤" },
    7: { title: "çŒ«é£¼ï½²ï¾€ï½²ï¾„æ€ï½¯ï¾ƒï¾€", flavor: "ã¤ã„ã«é£¼ãˆãŸã‚“ã â€¦" },
    8: { title: "Woï½«é¤…ï¾‚ï½·ğŸ¤ï¾ï½®ï½ï¾!!", flavor: "ã¿ã‚‡ãƒ¼ãƒ¼ãƒ¼ãƒ¼ã‚“" },
    9: { title: "ã½ãºã‚ãºã‚", flavor: "é‰„ç«å·»ãºã‚ãºã‚ã‚Šã‚“" },
    10: { title: "æä»è±†è…ï½¸ï¾šï¾–!ï¾šï½·ï¾ï½¯", flavor: "è¸Šã‚‹ï¾šï½·ï¾ï½" },
    11: { title: "ã‚Šã‚“ã”ã‚ã‚", flavor: "ã†ã‚‹ã‚‹ã‚“å¯æ„›ã„ï¾Šï¾ï½¸ï¾ã˜ã‚ƒãªã„ã§ã™" },
    12: { title: "ç™½èœäº‹ä»¶", flavor: "ã«ã‚ƒã‚“ã ãµã‚‹å²ã§ã‚‚æœ‰åãªäº‹ä»¶ã®ä¸€ã¤" },
    13: { title: "æš´ã‚Œã‚“åŠç…§æº–", flavor: "ã‚ˆãè€ƒãˆãŸã‚‰æš´ã‚ŒãŸã‚‰å±é™ºã ãª" },
    14: { title: "æŸ˜æ¦´", flavor: "æŸ˜æ¦´ã¡ã“ã‚ã“ã‚" },
    15: { title: "æ„Ÿé›»!KUâ˜†RAâ˜†GE", flavor: "æ°´é¥…é ­é£Ÿã¹ãŸããªã‚‹" },
    16: { title: "AIR", flavor: "ï¾Œï¾ï½°ï½°ï½°ï½°ï½°ï½°ï½°ï½°ï½°ï½°ï½°ï½°ï½°ï½°ï½°ï½°ï¾" },
    17: { title: "ä¸æ­»å·ä¸‹åƒ•", flavor: "ï¾’ã€ï¾’ï½½çŒ«ã¡ã‚ƒã‚“â€¦///" },
    18: { title: "ã«ã‚ƒã‚“ã ãµã‚‹ï¼ˆå®Ÿç‰©ï¼‰", flavor: "å“ºä¹³ç“¶ã§ã‚³ã‚³ã‚¢é£²ã¿ãŸã„" },
    19: { title: "å¾®èª²é‡‘", flavor: "å¾®èª²é‡‘ã¨ã¯â€¦ï½¸ï¾ï½¶ï½¸ï¾ï½¶" },
    20: { title: "ã„ã¡ã”ã¿ã‚‹ã", flavor: "ã„ã¡ã”ã¿ã‚‹ãã®ã„ã¡ã”æ½°ã™æ´¾ï¼Ÿ" },
    21: { title: "ã„ã—ã‚ˆã‚Â©ï¸(ã††.ã††)", flavor: "(ã††.ã††)" },
    22: { title: "ã~ã‚Šã£é…’ğŸ·", flavor: "èª¤å­—ã®ç‹æ§˜ğŸ¤" },
    23: { title: "å‰²å¼•ã‚¯ãƒ¼ãƒãƒ³", flavor: "å‰²å¼•ã£ã¦ã ã‘ã§æ°—æŒã¡ã„ã„///" },
    24: { title: "æ„›ã®ï¾ï½®ï½ºå†·ï¾ï½¼ï¾ï½©â™¡", flavor: "å›ºã„çµ†ã£ã¦â€¦å¤©æ‰ã‹" },
    25: { title: "ã¾ã‹ã‚ã‚“", flavor: "è¦‹ã¦ã¿ã¦ã€‚ã“ã‚Œå…¥ã‚Œæ­¯ğŸ¤" },
    26: { title: "â™ªã“ã‚“ã¶", flavor: "æ±Ÿæˆ¸æ™‚ä»£ã®é£›è„šã«ãªã£ãŸ" },
    27: { title: "é£Ÿä¸­æ¯’", flavor: "ãŒã‚“ã°ã‚ŒğŸ¤ãŒã‚“ã°ã‚ŒğŸ¤" },
    28: { title: "è‘±ããªã“ã‚¯ãƒªãƒ¼ãƒ ", flavor: "ã¡ã‚‡ã£ã¨ãŠã‚ã§ãŸã„æ„Ÿã˜ã™ã‚‹" },
    29: { title: "ï½ºï¾ï¾˜ç›Ÿä¸»", flavor: "ã¿ã‚“ãªã‚’æŠ±ãˆã¦èµ°ã‚Œã¾ã™///" },
    30: { title: "å’Œè§£", flavor: "å’Œè§£ã—ãŸã€‚" },
    31: { title: "ã«ã‚ƒã‚“ã ãµã‚‹ã§ãƒï½ã£ï½½", flavor: "ã†ãƒï½ï½½ï¼" },
    32: { title: "ã„ã¡ã“ï¼ˆã‚²ãƒ¼ãƒ ã®å§¿ï¼‰", flavor: "ã¶ã£ã¡ã‚…ã†ã†ã†ã†ï¼“ç§’å‰" },
    33: { title: "ã½ã“ï¼ˆã‚²ãƒ¼ãƒ ã®å§¿ï¼‰", flavor: "ã¨ã¦ã‚‚ç´³å£«çš„ã ãŒãŒã•ã¤" },
    34: { title: "AAAï¼ˆã‚²ãƒ¼ãƒ ã®å§¿ï¼‰", flavor: "ã¨ã¦ã‚‚ç´³å£«çš„ã ãŒé£½ãæ€§" },
    35: { title: "ã¿ã‚‹ãï¼ˆã‚²ãƒ¼ãƒ ã®å§¿ï¼‰", flavor: "ã¨ã¦ã‚‚ç´³å£«çš„ã ãŒå¤§é£Ÿæ¼¢" },
    36: { title: "ã­ãï¼ˆã‚²ãƒ¼ãƒ ã®å§¿ï¼‰", flavor: "ã¨ã¦ã‚‚ç´³å£«çš„ã ãŒç¥çµŒè³ª" },
    37: { title: "ã«ã‚ƒã‚“ã ãµã‚‹", flavor: "ã«ã‚ƒã‚“ã ãµã‚‹ï¼" },
    38: { title: "ï½½ï¾ï½·ï½­ï¾â™¡meetï¾ï¾ï½°ï¾™", flavor: "ã“ã‚Œã‹ã‚‰ã†ãšã‚‰åµã‚‚å°„æŠœãã¾ã™" },
    39: { title: "ç¿”Â©ï¸ï¾„ç”±ï½¶ï¾€ï¾ƒï¾ï½°ï¾„ï½¼ï¾€ï½²", flavor: "ã‚†ã‹ã¡ï¼ˆå¹¼å°‘æœŸã®å§¿ï¼‰" },
    40: { title: "ãªã‚“ã§å…‰ã£ã¦ã‚“ã ", flavor: "æœ¬é³¥ã«ã‚‚ã‚ã‹ã‚Šã¾ã›ã‚“ã€‚" },
    41: { title: "æ±‚ãƒ»æ‹è©±", flavor: "ç¾¤ãŒã‚Šã¾ã™ã€‚" },
    42: { title: "ã­ãåˆ‡ã‚Š", flavor: "å„„åˆ‡ã‚Šã®æ¼¢â€¦" },
    43: { title: "ã­ãããªã“ã‚¯ãƒªãƒ¼ãƒ ã‚‚ã¤", flavor: "æœ€çµ‚å½¢æ…‹" },
  };


  let ownedStickers = JSON.parse(localStorage.getItem("ownedStickers") || "[]");

  function renderStickers() {
    stickerGrid.innerHTML = "";
    for (let i = 1; i <= totalStickers; i++) {
      const btn = document.createElement("button");
      btn.textContent = i;
      btn.classList.add("sticker-button");
      if (ownedStickers.includes(i)) {
        btn.classList.add("owned");
        btn.disabled = false;
        btn.onclick = (e) => {
          e.stopPropagation();
          showSticker(i, false);
        };
      } else {
        btn.classList.add("locked");
        btn.disabled = true;
        btn.onclick = null;
      }
      stickerGrid.appendChild(btn);
    }
  }

  function showSticker(i, isGachaResult = true) {
    modalImage.src = `images2/sticker${i}.png`;
    stickerTitle.textContent = stickerData[i]?.title || `ã‚¹ãƒ†ãƒƒã‚«ãƒ¼ #${i}`;
    stickerFlavor.textContent = stickerData[i]?.flavor || "";

    if (isGachaResult) {
      modalImage.style.maxWidth = "1260px";
      modalImage.style.width = "auto";
      modal.style.maxWidth = "95%";
    } else {
      modalImage.style.maxWidth = "900px";
      modalImage.style.width = "auto";
      modal.style.maxWidth = "90%";
    }
    modal.style.display = "flex";
  }

  gachaButton.addEventListener("click", (e) => {
    e.stopPropagation();

    // ã‚µã‚¦ãƒ³ãƒ‰ã‚’å†ç”Ÿ
 gachaSound.play();
setTimeout(() => {
  gachaSound.pause();
  gachaSound.currentTime = 0;
}, 3000); // 3ç§’å¾Œã«åœæ­¢

    // æºã‚Œã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
    gachaMachine.classList.add("shake");
    setTimeout(() => {
      gachaMachine.classList.remove("shake");
    }, 2000);

    setTimeout(() => {
      const probabilities = [];
      for (let i = 1; i <= 43; i++) {
        if (i <= 26) probabilities[i] = (100 - (5 * 5 + 1 * 5 + 0.6 * 3 + 0.1 * 4)) / 26;
        else if (i >= 27 && i <= 31) probabilities[i] = 5;
        else if (i >= 32 && i <= 36) probabilities[i] = 1;
        else if (i >= 37 && i <= 39) probabilities[i] = 0.6;
        else if (i >= 40 && i <= 43) probabilities[i] = 0.1;
      }

      const rand = Math.random() * 100;
      let sum = 0;
      let newSticker = 1;
      for (let i = 1; i <= 43; i++) {
        sum += probabilities[i];
        if (rand <= sum) {
          newSticker = i;
          break;
        }
      }

      if (!ownedStickers.includes(newSticker)) {
        ownedStickers.push(newSticker);
        localStorage.setItem("ownedStickers", JSON.stringify(ownedStickers));
      }

      showSticker(newSticker, true);
      renderStickers();

    }, 3600);
  });

  modal.addEventListener("click", e => {
    e.stopPropagation();
  });

  document.addEventListener("click", (e) => {
    if (modal.style.display === "flex") {
      if (!modal.contains(e.target) && e.target !== gachaButton) {
        modal.style.display = "none";
      }
    }
  });

  renderStickers();
</script>

<p class="subtext">
  â€»éŸ³ãŒã§ã¾ã™<br>
  â€»ãƒ•ãƒ¬ãƒ¼ãƒãƒ¼ãƒ†ã‚­ã‚¹ãƒˆã¯å€‹äººã®ä¸»è¦³ã§ã™ã€‚<br>
  â€»ã“ã®ã‚¬ãƒãƒ£ã¯ãƒ–ãƒ©ã‚¦ã‚¶ã‚’æ›´æ–°ã—ãŸã‚Šã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢ã™ã‚‹ã¨ã€åé›†çŠ¶æ³ãŒãƒªã‚»ãƒƒãƒˆã•ã‚Œã¾ã™ã€‚ 
</p>
</body>
</html>
